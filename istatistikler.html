<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>İstatistikler - Sessiz Çığlık</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Data Labels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <style>
      html, body {
        margin: 0;
        padding: 0;
      }
      /* Make each chart container a perfect square and properly aligned */
      .stats-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        aspect-ratio: 1 / 1;
        height: 100%;
        min-height: 140px;
        max-width: 320px;
        margin-left: auto;
        margin-right: auto;
        padding-left: 1rem;
        padding-right: 1rem;
        margin-bottom: 3rem;
        opacity: 0;
        transform: translateY(30px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }
      .stats-card.visible {
        opacity: 1;
        transform: translateY(0);
      }
      /* Responsive alignment for each chart card */
      .stats-card.first-chart {
        align-items: flex-start;
        margin-left: calc(1rem + 5cm);
        margin-right: auto;
      }
      .stats-card.second-chart {
        align-items: flex-start;
        margin-left: calc(1rem + 15.5cm);
        margin-right: auto;
        /* Move the chart and its flex sibling (mini-card) up by 7cm. */
        transform: translateY(-10cm);
      }
      .stats-card.third-chart {
        align-items: flex-start;
        margin-left: calc(1rem + 5cm);
        margin-right: auto;
        /* Move the Kadın - Erkek Oranı chart and any siblings up by 15cm */
        transform: translateY(-10cm);
      }
      .stats-card.fourth-chart {
        align-items: flex-start;
        margin-left: calc(1rem + 15.5cm);
        margin-right: auto;
      }
      /* Move the Yaş Grupları chart up by 10cm on large screens */
      @media (min-width: 992px) {
        .stats-card.fourth-chart {
          transform: translateY(-9.5cm);
        }
      }
      .stats-card h5 {
        font-size: 1rem;
        margin-bottom: 0.5rem;
        margin-top: 0.25rem;
        text-align: left;
      }
      .stats-card .description {
        font-size: 0.85rem;
        margin-top: 0.5rem;
        margin-bottom: 0.25rem;
        text-align: left;
      }
      .stats-card canvas {
        display: block;
        width: 100% !important;
        height: 100% !important;
        aspect-ratio: 1 / 1;
        max-width: 100%;
        max-height: 100%;
        margin: 0;
        flex: 1 1 auto;
      }
      /* New mini-card style */
      .mini-card {
        background-color: rgba(45, 0, 90, 0.35); /* darker semi-transparent Pantone 19-3629 */
        color: white;
        padding: 1rem;
        border-radius: 0.375rem;
        box-shadow: 0 0.25rem 0.5rem rgba(0,0,0,0.08), 0 0.0625rem 0.125rem rgba(0,0,0,0.06);
        max-width: 350px;
        flex: 1.5 1 300px;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        min-height: 298px; /* Reduced by 1cm (~37px, was 335px) */
      }
      /* Move only the first mini-card (Kadın Cinayetleri özet kutusu) 1cm to the left */
      .mini-card.kadin-cinayetleri-ozet {
        transform: translateX(-1cm);
      }
      /* Move only the "Aile İçi Şiddet Vakaları" mini-card 5.5cm to the right */
      .mini-card.aile-siddet-ozet {
        margin-left: 5.5cm !important;
        transform: none !important;
      }
      /* Move the Yaş Grupları mini-card 3cm to the right and 20cm upward */
      .mini-card.yas-gruplari-ozet {
        transform: translate(5cm, -21cm);
      }
      /* Responsive adjustments for mobile */
      @media (max-width: 1200px) {
        .stats-card.first-chart,
        .stats-card.third-chart {
          margin-left: calc(1rem + 3cm);
        }
       
        }
       
      @media (max-width: 991px) {
        .stats-card.first-chart,
        .stats-card.third-chart {
          margin-left: 1rem;
        }
        .stats-card.second-chart,
        .stats-card.fourth-chart {
          margin-left: 1rem;
        }
       
        }
    
      @media (max-width: 767px) {
        .stats-card {
          min-height: 120px;
          max-width: 90vw;
          margin-left: auto !important;
          margin-right: auto !important;
          padding-left: 0.5rem;
          padding-right: 0.5rem;
          margin-bottom: 2rem;
        }
        .stats-card.first-chart,
        .stats-card.second-chart,
        .stats-card.third-chart,
        .stats-card.fourth-chart {
          margin-left: auto !important;
          margin-right: auto !important;
          align-items: center !important;
        }
        .stats-card h5,
        .stats-card .description {
          text-align: center !important;
        }
        /* Remove upward shift for second-chart and its flex sibling on mobile */
        .stats-card.second-chart {
          transform: translateY(0) !important;
        }
        /* Remove upward shift for third-chart on mobile */
        .stats-card.third-chart {
          transform: translateY(0) !important;
        }
        /* Remove upward shift for fourth-chart on mobile */
        .stats-card.fourth-chart {
          transform: translateY(0) !important;
        }
      }
      /* Responsive flex-wrap for mini-card and chart container */
      .d-flex.flex-wrap.align-items-start {
        flex-wrap: wrap;
      }
      @media (max-width: 767px) {
        .d-flex.flex-wrap.align-items-start > .stats-card,
        .d-flex.flex-wrap.align-items-start > .mini-card {
          margin-left: 0 !important;
          margin-right: 0 !important;
          max-width: 100% !important;
          flex: 1 1 100% !important;
          margin-top: 1rem;
          height: auto !important;
        }
        .mini-card {
          height: auto !important;
          min-height: 0 !important;
          transform: none !important;
          margin-left: 0 !important;
        }
        /* Ensure the Yaş Grupları mini-card is not moved up on mobile */
        .mini-card.yas-gruplari-ozet {
          transform: none !important;
        }
      }



    </style>
</head>
<body>
    <!-- NAVBAR START-->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <img src="./images/purple-ribbon.png">
            <a class="navbar-brand fw-bold" href="index.html">SESSİZ ÇIĞLIK</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                    <a class="nav-link" href="istatistikler.html">İstatistikler</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" href="siddetin_turleri.html">Şiddetin Türleri</a>
                    </li>
                    <li class="nav-item">
                    <a class="nav-link" href="istanbul_sozlesmesi.html">İstanbul Sözleşmesi</a>
                    </li>
                </ul>
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"/>
                    <button class="btn btn-outline-danger" type="submit">Search</button>
                </form>
            </div>
        </div>
    </nav>
    <!-- NAVBAR END-->

    <div class="container my-5">
      <h2 class="mb-4 text-center">İstatistikler</h2>
      
      <div class="d-flex flex-wrap align-items-start">
        <div style="display: flex; align-items: flex-start; gap: 3cm;">
          <div class="stats-card p-3 border rounded shadow-sm first-chart">
            <h5 class="mb-3">Kadın Cinayetleri (Yıllık)</h5>
            <canvas id="kadinCinayetleriChart"></canvas>
            <p class="description mt-3">Yıllara göre kadın cinayetleri vaka sayıları.</p>
          </div>
          <div class="mini-card kadin-cinayetleri-ozet">
            <h5>Özet</h5>
            <p>Bu grafik, 2018'den 2023'e kadar yıllık kadın cinayetleri vaka sayılarının değişimini göstermektedir. Veriler, artan ve azalan trendleri net bir şekilde ortaya koymaktadır.</p>
          </div>
        </div>
      </div>
      
      <div class="d-flex flex-wrap align-items-start" style="gap: 2cm;">
        <div class="mini-card aile-siddet-ozet">
          <h5>Özet</h5>
          <p>Bu grafik, 2018-2023 yılları arasında aile içi şiddet vakalarının yıllık artış ve azalış trendlerini göstermektedir. Veriler, toplumsal farkındalığın ve önleyici politikaların önemini vurgulamaktadır.</p>
        </div>
        <div class="stats-card p-3 border rounded shadow-sm second-chart">
          <h5 class="mb-3">Aile İçi Şiddet Vakaları</h5>
          <canvas id="aileSiddetChart"></canvas>
          <p class="description mt-3">Yıllık aile içi şiddet vakalarının dağılımı.</p>
        </div>
      </div>
      
      <div class="d-flex flex-wrap align-items-start" style="gap:2cm;">
        <div class="stats-card p-3 border rounded shadow-sm third-chart">
          <h5 class="mb-3">Kadın - Erkek Oranı</h5>
          <canvas id="kadinErkekChart"></canvas>
          <p class="description mt-3">Kadın ve erkek oranlarının karşılaştırması.</p>
        </div>
        <div class="mini-card kadin-erkek-ozet" style="background-color: rgba(45, 0, 90, 0.35); color: white; height: 100%; display: flex; align-items: center; min-width: 300px; max-width: 350px; transform: translate(-4cm, -10cm);">
          <p style="margin:0;">
            Bu grafik, kadın ve erkek oranlarının yüzdesel dağılımını göstermektedir. Veriler, toplumsal demografi ve cinsiyet oranlarını karşılaştırmalı olarak ortaya koymaktadır.
          </p>
        </div>
      </div>
      
      <div class="d-flex flex-wrap align-items-start" style="gap:2cm;">
        <div class="stats-card p-3 border rounded shadow-sm fourth-chart">
          <h5 class="mb-3">Yaş Grupları</h5>
          <canvas id="yasGruplariChart"></canvas>
          <p class="description mt-3">Farklı yaş gruplarına göre dağılım.</p>
        </div>
        <div class="mini-card yas-gruplari-ozet">
          <h5>Özet</h5>
          <p>
            Bu grafik, farklı yaş gruplarındaki kadınların oranlarını göstermektedir. En yüksek oran %35 ile 25-34 yaş grubuna aittir. Bunu %25 ile 18-24 yaş grubu takip etmektedir. Yaş ilerledikçe oranlarda azalma gözlenmektedir, bu da genç yaş gruplarının şiddet istatistiklerinde daha fazla yer tuttuğunu ortaya koymaktadır.
          </p>
        </div>
      </div>
      
    </div>


    <!-- Bootstrap JS Bundle (with Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Chart.js Scripts -->
    <script>
      // Register the datalabels plugin globally
      Chart.register(ChartDataLabels);

      // Chart instances storage
      const charts = {};

      // Chart config factories with animations disabled initially
      function createKadinCinayetleriChart(ctx) {
        return new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['2018', '2019', '2020', '2021', '2022', '2023'],
            datasets: [{
              label: 'Vaka Sayısı',
              data: [440, 474, 410, 420, 392, 370],
              borderColor: 'rgba(255, 99, 132, 1)',
              backgroundColor: 'rgba(255, 99, 132, 0.2)',
              fill: true,
              tension: 0.3,
              datalabels: {
                align: 'top',
                anchor: 'end',
                color: 'rgba(255, 99, 132, 1)',
                font: {
                  weight: 'bold',
                  size: 10
                },
                formatter: function(value, context) {
                  const max = Math.max(...context.dataset.data);
                  return ((value / max) * 100).toFixed(1) + '%';
                }
              }
            }]
          },
          options: {
            responsive: true,
            animation: { duration: 0 },
            plugins: {
              legend: {
                display: true,
                labels: { font: { size: 12 } },
                position: 'bottom'
              },
              datalabels: {
                display: true
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  font: { size: 10 }
                }
              },
              x: {
                ticks: {
                  font: { size: 10 }
                }
              }
            }
          }
        });
      }

      function createAileSiddetChart(ctx) {
        return new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['2018', '2019', '2020', '2021', '2022', '2023'],
            datasets: [{
              label: 'Vaka Sayısı',
              data: [12000, 13500, 15000, 16500, 18000, 17000],
              backgroundColor: 'rgba(54, 162, 235, 0.7)',
              borderColor: 'rgba(54, 162, 235, 1)',
              borderWidth: 1,
              datalabels: {
                anchor: 'end',
                align: 'top',
                color: 'rgba(54, 162, 235, 1)',
                font: {
                  weight: 'bold',
                  size: 10
                },
                formatter: function(value, context) {
                  const max = Math.max(...context.dataset.data);
                  return ((value / max) * 100).toFixed(1) + '%';
                }
              }
            }]
          },
          options: {
            responsive: true,
            animation: { duration: 0 },
            plugins: {
              legend: {
                display: true,
                labels: { font: { size: 12 } },
                position: 'bottom'
              },
              datalabels: {
                display: true
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  font: { size: 10 }
                }
              },
              x: {
                ticks: {
                  font: { size: 10 }
                }
              }
            }
          }
        });
      }

      function createKadinErkekChart(ctx) {
        return new Chart(ctx, {
          type: 'pie',
          data: {
            labels: ['Kadın', 'Erkek'],
            datasets: [{
              data: [62, 38],
              backgroundColor: [
                'rgba(255, 99, 132, 0.7)',
                'rgba(54, 162, 235, 0.7)'
              ],
              borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)'
              ],
              borderWidth: 1,
              datalabels: {
                color: '#fff',
                font: {
                  weight: 'bold',
                  size: 12
                },
                formatter: function(value) {
                  return value + '%';
                }
              }
            }]
          },
          options: {
            responsive: true,
            animation: { duration: 0 },
            plugins: {
              legend: {
                position: 'bottom',
                labels: { font: { size: 12 } }
              },
              datalabels: {
                display: true
              }
            }
          }
        });
      }

      function createYasGruplariChart(ctx) {
        return new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels: ['18-24', '25-34', '35-44', '45-54', '55+'],
            datasets: [{
              data: [25, 35, 20, 12, 8],
              backgroundColor: [
                'rgba(255, 206, 86, 0.7)',
                'rgba(75, 192, 192, 0.7)',
                'rgba(153, 102, 255, 0.7)',
                'rgba(255, 159, 64, 0.7)',
                'rgba(201, 203, 207, 0.7)'
              ],
              borderColor: [
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
                'rgba(201, 203, 207, 1)'
              ],
              borderWidth: 1,
              datalabels: {
                color: '#fff',
                font: {
                  weight: 'bold',
                  size: 12
                },
                formatter: function(value) {
                  return value + '%';
                }
              }
            }]
          },
          options: {
            responsive: true,
            animation: { duration: 0 },
            plugins: {
              legend: {
                position: 'bottom',
                labels: { font: { size: 12 } }
              },
              datalabels: {
                display: true
              }
            }
          }
        });
      }

      // Initialize charts without animation
      function initCharts() {
        charts.kadinCinayetleri = createKadinCinayetleriChart(document.getElementById('kadinCinayetleriChart').getContext('2d'));
        charts.aileSiddet = createAileSiddetChart(document.getElementById('aileSiddetChart').getContext('2d'));
        charts.kadinErkek = createKadinErkekChart(document.getElementById('kadinErkekChart').getContext('2d'));
        charts.yasGruplari = createYasGruplariChart(document.getElementById('yasGruplariChart').getContext('2d'));
      }

      // Animate a chart by updating its animation options and updating it
      function animateChart(chart) {
        if (!chart) return;
        // Update animation duration for all elements
        chart.options.animation = {
          duration: 1000,
          easing: 'easeOutQuart'
        };
        chart.update();
      }

      // IntersectionObserver callback
      function onIntersection(entries, observer) {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const card = entry.target;
            card.classList.add('visible');
            const canvas = card.querySelector('canvas');
            if (!canvas) return;
            let chartInstance;
            switch(canvas.id) {
              case 'kadinCinayetleriChart':
                chartInstance = charts.kadinCinayetleri;
                break;
              case 'aileSiddetChart':
                chartInstance = charts.aileSiddet;
                break;
              case 'kadinErkekChart':
                chartInstance = charts.kadinErkek;
                break;
              case 'yasGruplariChart':
                chartInstance = charts.yasGruplari;
                break;
            }
            if (chartInstance && !chartInstance._animated) {
              animateChart(chartInstance);
              chartInstance._animated = true; // prevent re-animation
            }
            observer.unobserve(card);
          }
        });
      }

      // Setup IntersectionObserver
      function setupObserver() {
        const options = {
          root: null,
          rootMargin: '0px',
          threshold: 0.3
        };
        const observer = new IntersectionObserver(onIntersection, options);
        document.querySelectorAll('.stats-card').forEach(card => {
          observer.observe(card);
        });
      }

      // Initialize everything after DOM content loaded
      document.addEventListener('DOMContentLoaded', () => {
        initCharts();
        setupObserver();
      });
    </script>

    <!-- FOOTER START-->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-logo">
                <h2>Sessiz Çığlık</h2>
            </div>
            <div class="footer-links">
                <a href="#hakkimizda">Hakkımızda</a>
                <a href="#iletisim">İletişim</a>
                <a href="#gizlilik">Gizlilik Politikası</a>
            </div>
            <div class="footer-social">
                <a href="#"><img src="./images/facebook-icon.png" alt="Facebook"></a>
                <a href="#"><img src="./images/x-iconpng.png" alt="X"></a>
                <a href="#"><img src="./images/instagram_icon.png" alt="Instagram"></a>
            </div>
        </div>
        <p class="footer-copy">© 2025 Sessiz Çığlık. Tüm hakları saklıdır.</p>
    </footer>
    <!--FOOTER END-->
</body>
</html>